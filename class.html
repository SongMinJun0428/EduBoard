<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>2-3ë°˜ í•™ê¸‰ ì‚¬ì´íŠ¸</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://unpkg.com/@supabase/supabase-js"></script>
  <style>
    body{
      margin:0;
      font-family:system-ui,sans-serif;
      background:#f8fafc;
      color:#1f2937;
      transition:background .3s,color .3s;
    }
    body.dark{background:#0f172a;color:#f1f5f9}
    header{
      background:linear-gradient(135deg,#4f46e5,#3b82f6);
      color:white;padding:1rem 1.5rem;
      display:flex;justify-content:space-between;align-items:center;
    }
    nav{display:flex;gap:.8rem;flex-wrap:wrap}
    .wrap{max-width:1000px;margin:20px auto;padding:0 1rem}
    h2{font-size:1.2rem;font-weight:600;margin:0 0 .75rem 0}
    .card{
      background:white;border-radius:1rem;padding:1.2rem;
      box-shadow:0 2px 8px rgba(0,0,0,0.05);margin-bottom:20px
    }
    header h1 {
  margin: 0;
  font-size: 1.6rem;   /* ì œëª© í¬ê²Œ */
  font-weight: 800;    /* ë” ë‘ê»ê²Œ */
  letter-spacing: 1px; /* ìê°„ ì¡°ê¸ˆ */
}

nav a {
  color: white;
  text-decoration: none;
  font-size: 1rem;      /* ë©”ë‰´ ê¸€ì”¨ ì¡°ê¸ˆ í¬ê²Œ */
  font-weight: 600;     /* êµµê²Œ */
}

nav a:hover {
  text-decoration: underline;
  color: #e0e7ff;       /* hover ì‹œ ì—°ë³´ë¼ìƒ‰ */
}

    body.dark .card{background:#1e293b}
    .grid-2{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px}
    .grid-4{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:12px}
    .btn{
      padding:.55rem .9rem;border-radius:.6rem;border:1px solid #d1d5db;
      background:white;font-size:.9rem;cursor:pointer
    }
    .btn.primary{background:#60a5fa;color:white;border:none}
    .btn.primary:hover{background:#3b82f6}
    body.dark .btn{background:#334155;color:#f1f5f9;border-color:#475569}
    ul{margin:0;padding-left:1rem}
    .seat{background:#f9fafb;border:1px solid #e2e8f0;border-radius:.5rem;padding:.5rem;text-align:center}
    body.dark .seat{background:#334155;border-color:#475569}
    .gallery-item{border:1px solid #e2e8f0;border-radius:.75rem;padding:.9rem;text-align:center;background:#fafafa}
    body.dark .gallery-item{background:#334155;border-color:#475569}
    .muted{color:#6b7280;font-size:.85rem}
    body.dark .muted{color:#94a3b8}

    /* ë°˜ì‘í˜• */
    @media(max-width:640px){
      header{flex-direction:column;align-items:flex-start}
      nav{display:none;flex-direction:column;gap:.5rem;margin-top:.5rem}
      nav.show{display:flex}
      .hamburger{display:block;cursor:pointer;margin-top:.5rem}
    }
    @media(min-width:641px){
      .hamburger{display:none}
    }
    /* ìë¦¬ ìŠ¤íƒ€ì¼ */
#seat-map {
  display: grid;
  grid-template-columns: repeat(5, 1fr); /* 5ì—´ */
  grid-template-rows: repeat(6, auto);   /* 6í–‰ */
  gap: 10px;
}
.seat {
  background:#f9fafb;
  border:1px solid #e2e8f0;
  border-radius:.5rem;
  padding:.7rem 1rem;
  text-align:center;
}
body.dark .seat {
  background:#334155;
  border-color:#475569;
  color:#f1f5f9;
}

  </style>
</head>
<body>
  <header>
    <div>
      <h1>ğŸ« 2-3ë°˜ í•™ê¸‰ ì‚¬ì´íŠ¸</h1>
      <div class="hamburger" onclick="toggleMenu()">â˜° ë©”ë‰´</div>
    </div>
    <nav id="nav">
      <a href="#notices">ê³µì§€</a>
      <a href="#assign">ê³¼ì œ</a>
      <a href="#timetable">ì‹œê°„í‘œ</a>
      <a href="#clean">ì²­ì†Œ/ìë¦¬</a>
      <a href="#test">í…ŒìŠ¤íŠ¸</a>
      <a href="#attendance">ì¶œì„</a>
      <a href="#gallery">ê°¤ëŸ¬ë¦¬</a>
      <a href="#points">í¬ì¸íŠ¸</a>
      <a href="#vote">íˆ¬í‘œ</a>
      <button class="btn" onclick="toggleDark()">ğŸŒ™ ëª¨ë“œ</button>
    </nav>
  </header>

  <div class="wrap">

    <!-- ë¹ ë¥¸ë©”ë‰´ -->
    <div class="card grid-4">
      <button class="btn primary" onclick="location.hash='#assign'">ğŸ“ ê³¼ì œ</button>
      <button class="btn primary" onclick="location.hash='#notices'">ğŸ“¢ ê³µì§€</button>
      <button class="btn primary" onclick="location.hash='#clean'">ğŸ§¹ ì²­ì†Œ/ìë¦¬</button>
      <button class="btn primary" onclick="location.hash='#test'">ğŸ“ í…ŒìŠ¤íŠ¸</button>
    </div>

    <!-- ê³µì§€ -->
    <div id="notices" class="card">
      <h2>ğŸ“¢ ê³µì§€ì‚¬í•­</h2>
      <div id="notice-list" class="muted">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘â€¦</div>
    </div>

    <!-- ê³¼ì œ + ì‹œê°„í‘œ -->
    <div class="grid-2">
      <div id="assign" class="card">
        <h2>ğŸ“ ê³¼ì œ</h2>
        <div id="assign-list" class="muted">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘â€¦</div>
      </div>
      <div id="timetable" class="card">
        <h2>ğŸ—“ï¸ ì‹œê°„í‘œ</h2>
        <div id="timetable-grid" class="grid-4"></div>
      </div>
    </div>

<div id="clean" class="card">
  <h2>ğŸ§¹ ì²­ì†Œ ë‹¹ë²ˆ & ğŸª‘ ìë¦¬ ë°°ì¹˜</h2>
  <button class="btn" onclick="shuffleSeats()">ğŸ”„ ìë¦¬ ë°”ê¾¸ê¸°</button>
  <div id="seat-map" style="margin-top:1rem"></div>
</div>  

    <!-- ì¶œì„ -->
    <div id="attendance" class="card">
      <h2>âœ… ì¶œì„ ì²´í¬</h2>
      <ul id="att-list"></ul>
    </div>

    <!-- ê°„ë‹¨ í…ŒìŠ¤íŠ¸ -->
    <div id="test" class="card">
      <h2>ğŸ“ ê°„ë‹¨ í…ŒìŠ¤íŠ¸</h2>
      <p class="muted">ë¬¸ì œ: 5 Ã— 6 = ?</p>
      <input id="test-answer" type="number" placeholder="ì •ë‹µ ì…ë ¥"
             style="padding:.5rem;border:1px solid #cbd5e1;border-radius:.5rem" />
      <button class="btn primary" onclick="checkTest()">ì œì¶œ</button>
      <div id="test-result" style="margin-top:.5rem"></div>
    </div>

    <!-- ê°¤ëŸ¬ë¦¬ -->
    <div id="gallery" class="card">
      <h2>ğŸ“‚ ìë£Œì‹¤ & ê°¤ëŸ¬ë¦¬</h2>
      <div id="files" class="grid-4"></div>
    </div>

    <!-- í¬ì¸íŠ¸ -->
    <div id="points" class="card">
      <h2>ğŸ† í¬ì¸íŠ¸ ë³´ë“œ</h2>
      <div id="points-list"></div>
    </div>

    <!-- íˆ¬í‘œ -->
    <div id="vote" class="card">
      <h2>ğŸ—³ï¸ í•™ê¸‰ íˆ¬í‘œ</h2>
      <p>ì²´ìœ¡ ì‹œê°„ì— í•˜ê³  ì‹¶ì€ ìš´ë™ì€?</p>
      <button class="btn" onclick="submitVote('ì¶•êµ¬')">âš½ ì¶•êµ¬</button>
      <button class="btn" onclick="submitVote('ë†êµ¬')">ğŸ€ ë†êµ¬</button>
      <button class="btn" onclick="submitVote('í”¼êµ¬')">ğŸ í”¼êµ¬</button>
      <div id="vote-result" class="muted" style="margin-top:.5rem"></div>
    </div>

  </div>

  <script>
    const $=(id)=>document.getElementById(id);

    /* ë©”ë‰´ í† ê¸€ */
    function toggleMenu(){ $('nav').classList.toggle('show'); }

    /* ë‹¤í¬ ëª¨ë“œ */
    function toggleDark(){ document.body.classList.toggle('dark'); }

    /* ê³µì§€ (ë”ë¯¸) */
    function loadNotices(){
      $('notice-list').innerHTML='<ul><li>ì¤‘ê°„í‰ê°€ ì•ˆë‚´</li><li>í˜„ì¥í•™ìŠµ ë™ì˜ì„œ ì œì¶œ</li></ul>';
    }

    /* ê³¼ì œ */
    function loadAssignments(){
      $('assign-list').innerHTML='<ul><li>ìˆ˜í•™ p.42~45</li><li>ê³¼í•™ ë³´ê³ ì„œ</li></ul>';
    }

    /* ì‹œê°„í‘œ */
    function loadTimetable(){
      $('timetable-grid').innerHTML='<div>êµ­ì–´</div><div>ìˆ˜í•™</div><div>ê³¼í•™</div><div>ì˜ì–´</div>';
    }
    function mark(btn,status){
      btn.parentElement.innerHTML=btn.parentElement.textContent.split(' ')[0]+" - "+status;
    }

    /* í…ŒìŠ¤íŠ¸ */
    function checkTest(){
      const val=Number($('test-answer').value),res=$('test-result');
      let score=localStorage.getItem('quizScore')||0;
      if(val===30){res.textContent='âœ… ì •ë‹µ! +5ì ';res.style.color='green';score=Number(score)+5;}
      else{res.textContent='âŒ ì˜¤ë‹µ';res.style.color='red';}
      localStorage.setItem('quizScore',score);
      loadPoints();
    }

    /* ê°¤ëŸ¬ë¦¬ */
    function loadGallery(){
      $('files').innerHTML='<div class="gallery-item">ì‚¬ì§„ ëª¨ìŒ</div><div class="gallery-item">ìˆ˜í•™ í”„ë¦°íŠ¸</div>';
    }

    /* í¬ì¸íŠ¸ */
    function loadPoints(){
      const score=localStorage.getItem('quizScore')||0;
      $('points-list').innerHTML='<p>ë‚´ ì ìˆ˜: '+score+'ì </p>';
    }

    /* íˆ¬í‘œ */
    function submitVote(choice){
      // localStorage ì €ì¥
      localStorage.setItem("voteChoice",choice);
      $('vote-result').textContent="ë‚´ ì„ íƒ: "+choice;

      // âœ… ì¶”í›„ API ì—°ë™ ì˜ˆì •
      // fetch("/api/vote", {
      //   method:"POST",
      //   headers:{"Content-Type":"application/json"},
      //   body:JSON.stringify({student:"í™ê¸¸ë™", choice})
      // });
    }
    function loadVote(){
      const saved=localStorage.getItem("voteChoice");
      if(saved) $('vote-result').textContent="ë‚´ ì„ íƒ: "+saved;
    }

    document.addEventListener('DOMContentLoaded',()=>{
      loadNotices();loadAssignments();loadTimetable();
      renderSeats(seats);loadAttendance();loadGallery();loadPoints();loadVote();
    });

    /* ìë¦¬ */
const seats=[
  'ì² ìˆ˜','ì˜í¬','ë¯¼ìˆ˜','ì§€ì€','ì¤€í˜¸',
  'ì˜ˆì§„','ê°€ì˜','ë™í˜„','í˜„ìˆ˜','ì„œì—°',
  'ë¯¼í˜¸','í•˜ì¤€','ìœ ì§„','ìŠ¹ë¯¼','ë‹¤í˜„',
  'ì‹œìš°','ë‚˜ì—°','ìˆ˜ë¹ˆ','ì—°ìš°','ì§€í˜¸',
  'í•˜ë¦°','íƒœí˜„','ì˜ˆì¤€','ë‹¤ì¸','ì£¼ì›',
  'ì„œìœ¤','ì§€ì›','í˜„ìš°','ì±„ì›','ë„ìœ¤'
];

function renderSeats(list){
  const container=$('seat-map');
  container.innerHTML='';
  list.forEach(name=>{
    const seatDiv=document.createElement('div');
    seatDiv.className='seat';
    seatDiv.textContent=name;
    container.appendChild(seatDiv);
  });
}

function shuffleSeats(){
  const arr=[...seats];
  for(let i=arr.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
  renderSeats(arr);
}
  const client = window.supabase.createClient(
    "https://ucmzrkwrsezfdjnnwsww.supabase.co", // âœ… Supabase URL
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVjbXpya3dyc2V6ZmRqbm53c3d3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI4NDIzODcsImV4cCI6MjA2ODQxODM4N30.rvLItmDStjWb3GfECnCXocHvj-CMTfHfD1CHsAHOLaw"                     // âœ… Supabase anon key
  );

async function loadNotices(){
    const { data, error } = await client
      .from("notices")
      .select("title, content, created_at")
      .eq("grade",2).eq("class_num",3)
      .order("created_at",{ascending:false});

    if(error){
      $('notice-list').innerHTML="âŒ ê³µì§€ ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜";
      return;
    }
    $('notice-list').innerHTML = data?.length
      ? "<ul>" + data.map(n=>`<li><b>${n.title}</b> - ${n.content}</li>`).join("") + "</ul>"
      : "ê³µì§€ ì—†ìŒ";
  }

  async function loadAssignments(){
    const { data, error } = await client
      .from("assignments")
      .select("title, deadline")
      .eq("grade",2).eq("class_num",3)
      .order("deadline",{ascending:true});

    if(error){ $('assign-list').innerHTML="âŒ ê³¼ì œ ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜"; return; }
    $('assign-list').innerHTML = data?.length
      ? "<ul>" + data.map(a=>`<li>${a.title} (${a.deadline})</li>`).join("") + "</ul>"
      : "ê³¼ì œ ì—†ìŒ";
  }

  async function loadTimetable(){
    const { data, error } = await client
      .from("timetable")
      .select("day, subject, period")
      .eq("grade",2).eq("class_num",3)
      .order("day").order("period");

    if(error){ $('timetable-grid').innerHTML="âŒ ì‹œê°„í‘œ ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜"; return; }
    $('timetable-grid').innerHTML = data.map(t=>
      `<div>${t.day}êµì‹œ ${t.subject}</div>`
    ).join("");
  }

  async function loadAttendance(){
    const { data, error } = await client
      .from("users")
      .select("name")
      .eq("grade",2).eq("class_num",3)
      .order("student_number");

    if(error){ $('att-list').innerHTML="âŒ ì¶œì„ ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜"; return; }
    const ul=$('att-list'); ul.innerHTML="";
    data.forEach(u=>{
      const li=document.createElement('li');
      li.innerHTML=`${u.name} 
        <button class="btn" onclick="mark(this,'ì¶œì„')">ì¶œì„</button>
        <button class="btn" onclick="mark(this,'ì§€ê°')">ì§€ê°</button>
        <button class="btn" onclick="mark(this,'ê²°ì„')">ê²°ì„</button>`;
      ul.appendChild(li);
    });
  }

  document.addEventListener('DOMContentLoaded',()=>{
    loadNotices();
    loadAssignments();
    loadTimetable();
    loadAttendance();
  });
  </script>
</body>
</html>
